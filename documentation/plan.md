# План автоматизации тестирования веб-сервиса покупки туров

**Содержание:**
1. [Описание приложения](plan.md#1-описание-приложения)
2. [Тестовые данные](plan.md#2-тестовые-данные)
3. [Границы веб-сервиса](plan.md#3-границы-веб-сервиса)
4. [Тестовая документация](plan.md#4-тестовая-документация)
5. [Критерии начала и окончания тестирования](plan.md#5-критерии-начала-и-окончания-тестирования)
6. [Виды тестирования](plan.md#6-виды-тестирования)
7. [Перечень автоматизируемых сценариев](plan.md#7-перечень-автоматизируемых-сценариев)
8. [Перечень необходимых специалистов для автоматизации](plan.md#8-перечень-необходимых-специалистов-для-автоматизации)
9. [Перечень используемых инструментов](plan.md#9-перечень-используемых-инструментов)
10. [Окружение для тестирования](plan.md#10-окружение-для-тестирования)
11. [Возможные риски](plan.md#11-возможные-риски)
12. [Интервальная оценка с учётом рисков](plan.md#12-интервальная-оценка-с-учётом-рисков)
13. [План сдачи работ](plan.md#13-план-сдачи-работ)

<br>

## 1. Описание приложения
- Приложение — это веб-сервис, который предлагает купить тур по определённой цене двумя способами:
    * Обычная оплата по дебетовой карте.
    * Уникальная технология: выдача кредита по данным банковской карты.

- Само приложение не обрабатывает данные по картам, а пересылает их банковским сервисам:
    * сервису платежей, далее Payment Gate;
    * кредитному сервису, далее Credit Gate.

<br>

## 2. Тестовые данные

- Сервис обрабатывает только специальные номера карт, которые предоставлены для тестирования:

    * Карта со статусом **APPROVED** - `4444 4444 4444 4441`
    * Карта со статусом **DECLINED** - `4444 4444 4444 4442`

<br>

## 3. Границы веб-сервиса
Рекламная страница **"Путешествие дня"** с возможностью выбора способа покупки:
- Кнопка: **Купить**
    * Форма **"Оплата по карте"** с полями:
        * Номер карты
        * Месяц
        * Год
        * Владелец
        * CVC/CVV
    * Кнопка: **Продолжить**

- Кнопка: **Купить в кредит**
    * Форма **"Кредит по данным карты"** с полями:
        * Номер карты
        * Месяц
        * Год
        * Владелец
        * CVC/CVV
    * Кнопка: **Продолжить**

<br>

## 4. Тестовая документация
- `README.md` - инструкция по запуску авто-тестов
- `plan.md` - план автоматизации (этот документ)
- `report.md` - отчет о тестировании
- `summary.md` - итоги автоматизации
- `allure-report` - результаты выполнения тестов
- `Issues` в репозитории - найденные баги

<br> 

## 5. Критерии начала и окончания тестирования
### Критерии начала тестирования
- **Наличие необходимых данных**
    * Есть доступ к необходимым входным данным, которые могут включать `data.json` с тестовыми картами от эмулятора банка.
- **Готовность тестовой среды**
    * Установлен и запущен веб-сервис (эмулятор).
    * Установлены все необходимые инструменты и зависимости.

### Критерии окончания тестирования
- **Покрытие тестами**
    * Авто-тесты покрыли 100% критических сценариев:
        * Оплата/кредит по валидной/невалидной карте.
        * Валидация всех полей формы.
        * Проверка записей в СУБД.
- **Отсутствие критических и серьезных багов**
    * Критические баги (блокирующие оплату/кредит) исправлены или приняты осознанно.
- **Ограничение по времени**
    * Ограничение по времени с оценкой воздействия оставшихся рисков на продукт.
- **Отчетность**
    * Подготовлены все необходимые отчеты о тестировании, включая баг-репорты.
- **Результаты ревью**
    * Проведён демо-разбор с командой (разработчики, QA, продукт-менеджер).
    * Получено согласие на релиз или составлен план исправлений.

<br>

## 6. Виды тестирования
### Исследовательское тестирование:
- В отсутствие чётких требований может быть полезно провести исследовательское тестирование, чтобы выявить неочевидные сценарии работы форм оплаты и кредита. Это позволит выявить любые неявные требования или ограничения.
### Функциональное тестирование:
- Важно проверить, работают ли все функции формы оплаты по карте и формы кредита по данным карты так, как задумано. Это позволит выявить любые несоответствия между ожидаемыми и фактическими результатами.
### Интеграционное тестирование:
- Проверка корректности взаимодействия с эмулятором банка (Payment Gate/Credit Gate) и анализ ответов банка и записей в СУБД.
    * Проверка сквозной логики работы системы:
        * Приложение правильно формирует запросы к банковским сервисам (Payment Gate/Credit Gate)
        * Обрабатывает ответы (одобрение/отказ)
        * Сохраняет результат в СУБД без данных карт (соответствие PCI DSS)
    * Обнаружение рассогласованности между компонентами:
        * Несоответствие формата запроса ожиданиям эмулятора
        * Ошибки в сохранении статуса платежа (например, APPROVED вместо DECLINED)
        * Лишние/недостающие поля в записях БД
    * Проверка корректности тестовых данных:
        * Эмулятор возвращает ожидаемые ответы для одобренных карт (`4444 4444 4444 4441`)
        * Для отклонённых карт (`4444 4444 4444 4442`)
        * Для ошибочных сценариев
    * Подтверждение безопасности (Верификация):
        * Данные карт не сохраняются в СУБД (только статус и способ оплаты)
        * Логи не содержат дополнительной информации

<br>

## 7. Перечень автоматизируемых сценариев

### Позитивные сценарии покупки и кредита:
- **По данным карты (`APPROVED`)**
    * Ввод валидных данных одобренной карты.
    * Проверка успешного сообщения.
    * Проверка записи в БД (`status = APPROVED`)

- **По данным карты (`DECLINED`)**
    * Ввод валидных данных отклоненной карты
    * Проверка сообщения об ошибке
    * Проверка записи в БД (`status = DECLINED`)

### Негативные сценарии покупки и кредита по карте:
- **Неполные данные**
    * Проверка всех полей формы на обязательность заполнения
    * Проверка сообщений валидации

- **Несуществующая карта**
    * Ввод данных несуществующей карты
    * Проверка сообщения об ошибке

- **Короткий номер карты**
    * Ввод не полного номера карты (`4444 4444 4444 444 `)
    * Проверка сообщения об ошибке

- **Неверный месяц (00/13)**
    * Ввод месяца 00 или 13
    * Проверка сообщения об ошибке

- **Истекший срок действия карты**
    * Ввод карты с прошедшим месяцем/годом
    * Проверка сообщения об ошибке

- **Превышающий срок действия карты**
    * Ввод года больше текущего на 5 лет
    * Проверить сообщение об ошибке

- **Только имя в поле "Владелец"**
    * Ввод только имени без фамилии
    * Проверить сообщение об ошибке

- **Владелец на кириллице**
    * Ввод имени и фамилии владельца на кириллице
    * Проверить сообщение об ошибке

- **Слишком длинное имя владельца**
    * Ввод более 50 символом в поле владельца
    * Проверить сообщение об ошибке

- **Цифры и спецсимволы в поле "Владелец"**
    * Ввод цифр и спецсимволов в поле владельца
    * Проверить сообщение об ошибке


- **Неверный формат CVC/CVV**
    * Ввод неверного CVV (2 цифры)
    * Проверка сообщение об ошибке

### Примечание
- **Каждый сценарий проверяется отдельно для:**

    * Обычной оплаты по карте
    * Кредита по данным карты
- **После невалидной оплаты заказ не должен создаваться в БД**

<br>

## 8. Перечень необходимых специалистов для автоматизации
Инженер по автоматизации тестирования – создание и поддержка автоматических тестов.

<br>

## 9. Перечень используемых инструментов
- **`IntelliJ IDEA`** - мощная IDE с поддержкой Java, плагинами для тестирования и удобным дебаггингом.
- **`Selenide`** - фреймворк для UI-тестов с автоматическим управлением браузером и встроенными скриншотами.
- **`Java JDK 11`** - язык программирования со стабильной LTS-версией и богатой экосистемой для авто-тестов.
- **`Gradle`** - быстрая и гибкая система сборки с простым управлением зависимостями.
- **`JUnit 5`** - современный фреймворк для структурированных тестов с поддержкой параметризации.
- **`Docker`** + **`Docker Compose`** - изолированное и воспроизводимое тестовое окружение (СУБД, эмулятор банка).
- **`MySQL`** + **`PostgreSQL`** - проверка работы приложения с разными СУБД.
- **`Lombok`** - сокращение boilerplate-кода через аннотации.
- **`Faker`** - генерация случайных тестовых данных.
- **`DevTools`** — отладка селекторов и анализ запросов в браузере.
- **`DBeaver`** - управление базами данных (СУБД) через графический интерфейс.
- **`Allure`** - детализированные и интерактивные отчёты о прогонах.
- **`Git`** + **`GitHub`** — контроль версий и интеграция с CI/CD.

<br>

## 10. Окружение для тестирования
- **Компьютер для разработки**
    * **Модель:** MacBook Pro M1
    * **Процессор:** Apple M1
    * **Операционная система:** macOS версия Sequoia 15.3.2


## 11. Возможные риски
- **Изменение структуры DOM** - может привести к падению UI-тестов
    * Частые изменения вёрстки ломают локаторы в Selenide-тестах.
- **Различия в работе с разными СУБД**- могут потребоваться дополнительные настройки
    * MySQL и PostgreSQL могут по-разному обрабатывать данные (например, типы полей, транзакции).
- **Ограничения по времени** - сложность оценки времени на настройку окружения
    * Настройка Docker, эмулятора банка и SUT занимает больше времени, чем ожидалось.
- **Проблемы с локаторами** - динамические ID элементов могут усложнить тестирование
    * Элементы с генерируемыми ID (например, `id="button-12345"`) усложняют поиск.

<br>

## 12. Интервальная оценка с учётом рисков
- **Настройка окружения (Docker, СУБД, эмулятор)**: 8-12 часов
- **Написание тестов:** 30-40 часов
- **Настройка отчетов и CI:** 4-8 часов
- **Отладка и исправление тестов:** 8-12 часов
- **Подготовка документации:** 4-6 часов
#### Итого: 54-78 часов

<br>

## 13. План сдачи работ
- **План автоматизации** - 3 дня с начала работы
- **Авто-тесты** - готовы через 1.5 недели
- **Результаты прогона** - через 2 недели
- **Отчет по автоматизации** - через 2.5 недели